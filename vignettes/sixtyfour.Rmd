---
title: "Getting Started"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Getting Started}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---



A science-focused, more humane R interface to AWS.


``` r
library(sixtyfour)
```

## Authentication

To be able to use this package you'll need two AWS secrets and an AWS region in the following three environment variables:

- `AWS_ACCESS_KEY_ID`
- `AWS_SECRET_ACCESS_KEY`
- `AWS_REGION`

You can set these within R for the current R session like:

```
Sys.setenv(
  AWS_ACCESS_KEY_ID = "",
  AWS_SECRET_ACCESS_KEY = "",
  AWS_REGION = "us-west-2"
)
```

Or set them in a variety of ways to be available across R sessions. See the [R Startup chapter][r-startup] of _What They Forgot to Teach You About R_ book for more details.


## Package API Overview

- `aws_billing*`: manage AWS billing details
- `aws_bucket*`: manage S3 buckets
- `aws_file_*`: manage files in S3 buckets
- `aws_user*`: manage AWS users
- `aws_group*`: manage AWS groups
- `aws_role*`: manage AWS roles
- `aws_policy*`/`aws_policies*`: manage AWS policies
- `aws_db*`: interact with AWS database services Redshift and RDS
- `aws_secrets*`: secrets manager
- `aws_vpc*`: VPC security groups
- `con_*`: connection classes to various AWS services
- `six_*`: magical methods

## Working with S3

We cover S3 in detail in another vignette (`vignette("s3")`), so we'll briefly touch on it here.

### Buckets

Make a random bucket name


``` r
bucket <- random_string("egs-")
```

Create a bucket - check if it exists first


``` r
exists <- aws_bucket_exists(bucket)

if (!exists) {
  aws_bucket_create(bucket)
}
#> [1] "http://egs-dwpkqbyt.s3.amazonaws.com/"
```


``` r
aws_bucket_delete(bucket)
```

### Files

First, create a bucket:


``` r
my_bucket <- random_string("egs-")
aws_bucket_create(my_bucket)
#> [1] "http://egs-lfuxdjhg.s3.amazonaws.com/"
```

Then, upload some files


``` r
temp_files <- replicate(n = 3, tempfile(fileext = ".txt"))
for (i in temp_files) cat(letters, "\n", file = i)
remote_files <- s3_path(my_bucket, basename(temp_files))
aws_file_upload(path = temp_files, remote_path = remote_files)
#> [1] "s3://egs-lfuxdjhg/filec3bc796c5a41.txt"
#> [2] "s3://egs-lfuxdjhg/filec3bc38999fae.txt"
#> [3] "s3://egs-lfuxdjhg/filec3bc6dc27589.txt"
```

List files in the bucket


``` r
obs <- aws_bucket_list_objects(my_bucket)
obs
#> # A tibble: 3 × 8
#>   bucket       key      uri    size type  etag  lastmodified        storageclass
#>   <glue>       <chr>    <glu> <fs:> <chr> <chr> <dttm>              <chr>       
#> 1 egs-lfuxdjhg filec3b… s3:/…    53 file  "\"a… 2024-12-12 18:56:55 STANDARD    
#> 2 egs-lfuxdjhg filec3b… s3:/…    53 file  "\"a… 2024-12-12 18:56:55 STANDARD    
#> 3 egs-lfuxdjhg filec3b… s3:/…    53 file  "\"a… 2024-12-12 18:56:55 STANDARD
```



## Billing

Billing is covered in the `vignette("billing")` vignette.

## IAM

IAM stands for Identity Access Management. IAM covers the four resource types:

- Users: via `aws_user*` functions
- Groups: via `aws_group*` functions
- Roles: via `aws_role*` functions
- Policies: via `aws_policy*`/`aws_policies*` functions

As a brief example let's create a group, a user, and two roles. We'll assign the user to a role, and the group to the other role. Then clean it all up.

First, create a group


``` r
random_string("gr-")
#> gr-tizblrpv
aws_group_create("testgroup")
#> Error: EntityAlreadyExists (HTTP 409). Group with name testgroup already exists.
```

## Databases

Databases are covered in the `vignette("databases")` vignette.

## Magical methods

Magical methods are higher level functions to make your life easier.

As an example, `six_user_create()` creates a new user, including a) creating the appropriate policy if it doesn't exist yet, b) attaching the policy to the created user, and c) creating an AWS Access Key for the user (and copy an email template to your clipboard with the details a the new user needs).


``` r
name <- random_user()
name
#> [1] "InflateAllies"
six_user_create(name)
#> ℹ Added policy UserInfo to InflateAllies
#> ✔ Key pair created for InflateAllies
#> ℹ UserName: InflateAllies
#> ℹ Status: Active
#> ℹ CreateDate: 2024-12-12 18:56:59
#> ℹ AwsRegion: us-west-2
#> ℹ Email template copied to your clipboard
```



There are other magical methods. See the [docs](https://getwilds.org/sixtyfour/reference/#high-level-magical-methods) for more information.

[r-startup]: https://rstats.wtf/r-startup.html
